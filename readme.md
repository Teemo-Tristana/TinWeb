å‚è€ƒç¤¾é•¿çš„é¡¹ç›®å’Œæ¸¸åŒè€å¸ˆçš„<<Linuxé«˜æ€§èƒ½æœåŠ¡å™¨ç¼–ç¨‹>>å®ç°çš„è½»é‡çº§æœåŠ¡å™¨ TingyWeb é¡¹ç›®

Raw_versionæ–‡æ¡£
===============
Linuxä¸‹C++ç”¨æ¥å­¦ä¹ çš„WebæœåŠ¡å™¨ï¼Œç»“åˆä¹‹å‰çš„å­¦ä¹ ï¼Œæ­å»ºè½»é‡çº§æœåŠ¡å™¨ã€‚
* åŸºäºBSæ¨¡å‹ï¼Œï¼Œé‡‡ç”¨epollè¾¹æ²¿è§¦å‘æ¨¡å¼(ET)æ¥å®ç°IOå¤ç”¨ï¼Œä½¿ç”¨åŒæ­¥IOæ¨¡æ‹ŸProactoräº‹ä»¶å¤„ç†æ¨¡å¼çš„å¹¶å‘æ¨¡å‹
* ä½¿ç”¨çŠ¶æ€æœºè§£æhttpæŠ¥æ–‡ï¼šä¸»çŠ¶æ€æœºå†…éƒ¨è°ƒç”¨ä»çŠ¶æ€æœºï¼Œä»çŠ¶æ€æœºé©±åŠ¨ä¸»çŠ¶æ€æœºã€‚
* é‡‡ç”¨åŸºäºæ—¶é—´è½®çš„å®šæ—¶å™¨å®šæœŸå¤„ç†**éæ´»è·ƒè¿æ¥**
* æ”¯æŒç”¨æˆ·**æ³¨å†Œï¼Œç™»å½•**åŠŸèƒ½ï¼Œæ”¯æŒpostå’Œgetæ–¹æ³•
* å®ç°**æ—¥å¿—ç³»ç»Ÿ**[åŒæ­¥/å¼‚æ­¥]è®°å½•æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€ï¼Œ
* ç»Webbenchå‹åŠ›æµ‹è¯•å¯ä»¥å®ç°**ä¸Šä¸‡çš„å¹¶å‘è¿æ¥**æ•°æ®äº¤æ¢

åŸºç¡€æµ‹è¯•
------------
* æœåŠ¡å™¨æµ‹è¯•ç¯å¢ƒ
	* Ubuntuç‰ˆæœ¬16.04
	* MySQL 8.0.21 ç‰ˆ
* æµè§ˆå™¨æµ‹è¯•ç¯å¢ƒ 
	* Chrome
	* FireFox

* æå‰å®‰è£…MySQLæ•°æ®åº“
* é‡‡ç”¨æ•°æ®åº“ä¿å­˜ç”¨æˆ·å’Œå¯†ç ï¼Œå› æ­¤éœ€è¦æå‰å®‰è£…mysql[æœ¬é¡¹ç›®ä¸­ä½¿ç”¨çš„Mysql 8.0.21 ]

* util ä¸­çš„ create æŒ‡å®šæ•°æ®åº“åå’Œè¡¨åå³å¯ã€å¯ä»¥æŒ‡å®šä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤çš„æ–¹å¼ã€‘
```C++
    //æå‰å®‰è£…mysql
    string dbname =  "tinywebdb";//"tinywebdb";
    string tbname = "userinfo";
```
* æµ‹è¯•å‰ç¡®è®¤å·²å®‰è£…MySQLæ•°æ®åº“

* ä¿®æ”¹main.cä¸­çš„æ•°æ®åº“åˆå§‹åŒ–ä¿¡æ¯

    ```C++
    // root rootä¿®æ”¹ä¸ºæœåŠ¡å™¨æ•°æ®åº“çš„ç™»å½•åå’Œå¯†ç 
	// qgydbä¿®æ”¹ä¸ºä¸Šè¿°åˆ›å»ºçš„yourdbåº“å
    connPool->init("localhost", "root", "root", "yourdb", 3306, 8);
    ```

* ä¿®æ”¹http_conn.cppä¸­çš„rootè·¯å¾„

    ```C++
	// ä¿®æ”¹ä¸ºrootæ–‡ä»¶å¤¹æ‰€åœ¨è·¯å¾„
    const char* doc_root="/home/qgy/TinyWebServer/root";
    ```

* ç”Ÿæˆserver

    ```C++
    make server
    ```

* å¯åŠ¨server

    ```C++
    ./server port
    //eg: ./server 12345
    ```

* æµè§ˆå™¨ç«¯è®¿é—®ï¼š

    ```C++
    ip:port
    //egï¼šhttp://49.234.91.121:12345
    ```
MyTinyWebServer:ä¸€ä¸ªLinuxä¸‹C++è½»é‡çº§WebæœåŠ¡å™¨
============================================
+ ç»„æˆ:åˆ†ä¸º8ä¸ªæ¨¡å—
    + lock(çº¿ç¨‹åŒæ­¥)æ¨¡å—[è§lockæ–‡ä»¶å¤¹]

    + æ•°æ®åº“æ¨¡å—ï¼š
        - mysqlè¿æ¥æ± æ¨¡å—[è§CGImysqlæ–‡ä»¶å¤¹]

    + å®šæ—¶å™¨[è§timeræ–‡ä»¶å¤¹]
        - åŸºäºæ—¶é—´è½®çš„å®šæ—¶å™¨

    + pthreadpool(çº¿ç¨‹æ± )æ¨¡å—[è§threadpoolæ–‡ä»¶å¤¹]

    + http(httpè§£æå’Œå“åº”)æ¨¡å—[è§httpæ–‡ä»¶å¤¹]
        + httpè§£æç±»ï¼šä½¿ç”¨æœ‰é™çŠ¶æ€æœºçš„è®¾è®¡æ€æƒ³ï¼Œå°è£…äº†httpè¿æ¥å¤„ç†ç±»ï¼Œä»¥å®ç°è§£ææŠ¥æ–‡è¯·æ±‚å’Œå‘é€ã€‚[è¿™é‡Œåªæœ‰ä¸»çŠ¶æ€æœºå’Œä»çŠ¶æ€æœº]
    + æ—¥å¿—ç³»ç»Ÿ[è§logæ–‡ä»¶å¤¹]
        + åŒæ­¥æ—¥å¿—
        + å¼‚æ­¥æ—¥å¿—

    + æµ‹å‹æ¨¡å—[test_presure]
        - è¿™æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æµ‹è¯•å·¥å…·
    
    + rootæ¨¡å—[å°†rootæ–‡ä»¶å¤¹]
        + æ–‡ä»¶
        + é¡µé¢(html)

    + mainæ¨¡å—[å°†mainæ–‡ä»¶å¤¹]


```
webbench -c 500 -t 5 http://127.0.0.1:5678/6
500 clients, running 5 sec.
```

+ æ—¶é—´è½®å®šæ—¶å™¨ + mysql
```
Speed=1134156 pages/min, 2117068 bytes/sec.
Requests: 94513 susceed, 0 failed.
```
ğŸ”— TinyWebæœåŠ¡å™¨åœ°å€ï¼š http://49.234.91.121:12345/
æ¬¢è¿è®¿é—®
